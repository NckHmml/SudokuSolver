(function(){"use strict";function n(){document.addEventListener("pause",t.bind(this),!1);document.addEventListener("resume",i.bind(this),!1)}function t(){}function i(){}document.addEventListener("deviceready",n.bind(this),!1)})();$(function(){function t(n){switch(n){case"field":return i();default:return null}}function i(){for(var t,i={blocks:[]},n=0;n<9;n++)for(i.blocks.push([]),t=0;t<9;t++)i.blocks[n].push({x:t,y:n});return i}function r(){var t,i;$("select:not([data-x='']):not([data-y=''])").removeClass("invalid");var r=$(this),o=r.attr("data-x"),s=r.attr("data-y"),n=[];for(t=0;t<9;t++)for(n.push([]),i=0;i<9;i++)n[t].push(null);$("select:not([data-x='']):not([data-y=''])").each(function(){var t=$(this).attr("data-x"),i=$(this).attr("data-y");n[t][i]=$(this).val()});u(n);f(n);e(n)}function u(n){for(var f,t,e,o,i,r,u=1;u<=9;u++)for(f=[],t=0;t<9;t++){for(f.push(0),e=t%3,o=t-t%3,e*=3,i=0;i<3;i++)for(r=0;r<3;r++)n[i+e][r+o]==u&&f[t]++;if(f[t]>1)for(i=0;i<3;i++)for(r=0;r<3;r++)$("select[data-x='"+(i+e)+"'][data-y='"+(r+o)+"']").addClass("invalid")}}function f(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[u][t]==i&&r[t]++;r[t]>1&&$("select[data-y='"+t+"']").addClass("invalid")}}function e(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[t][u]==i&&r[t]++;r[t]>1&&$("select[data-x='"+t+"']").addClass("invalid")}}function o(){var a=0,u,f,e,v,r,o,l,t,i;do{for(u=[],f=[],e=0;e<9;e++)for(u.push([]),f.push([]),v=0;v<9;v++){for(u[e].push([]),r=1;r<=9;r++)u[e][v].push(r);f[e].push(null)}for($("select:not([data-x='']):not([data-y=''])").each(function(){var n=$(this).attr("data-x"),t=$(this).attr("data-y");f[n][t]=$(this).val()}),t=0;t<9;t++)for(i=0;i<9;i++){if(f[t][i]!=""){u[t][i]=[];continue}for(r=1;r<=9;r++)s(f,t,i,r)?h(f,t,i,r)?c(f,t,i,r)||n(u[t][i],r):n(u[t][i],r):n(u[t][i],r)}for(a=0,t=0;t<9;t++)for(i=0;i<9;i++)u[t][i].length===1&&(a++,f[t][i]=u[t][i],u[t][i]=[]);for(r=1;r<=1;r++)for(o=0;o<9;o++){var y=[],p=o%3,w=o-o%3;for(p*=3,t=p;t<p+3;t++)for(i=w;i<w+3;i++)u[t][i].indexOf(r)>=0&&y.push({x:t,y:i});y.length===1&&(l=y[0],a++,f[l.x][l.y]=r,u[l.x][l.y]=[])}for(t=0;t<9;t++)for(i=0;i<9;i++)$("select[data-x='"+t+"'][data-y='"+i+"']").val(f[t][i])}while(a>0)}function s(n,t,i,r){for(var u=0;u<9;u++)if(t!==u&&n[u][i]==r)return!1;return!0}function h(n,t,i,r){for(var u=0;u<9;u++)if(i!==u&&n[t][u]==r)return!1;return!0}function c(n,t,i,r){for(var u,e=t-t%3,o=i-i%3,f=e;f<e+3;f++)for(u=o;u<o+3;u++)if((i!==u||t!=f)&&n[f][u]==r)return!1;return!0}function n(n,t){var i=n.indexOf(t);n.splice(i,1)}$("#btnSolve").on("click",o);$("[data-template]").each(function(n,i){var u=$(i),f=u.attr("data-template"),e=$("[data-template-name='"+f+"']").html(),o=t(f),s=Mustache.render(e,o);u.append(s);$("select:not([data-x='']):not([data-y=''])").on("change",r)})});