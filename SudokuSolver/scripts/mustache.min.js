/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
(function(n,t){typeof exports=="object"&&exports?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):t(n.Mustache={})})(this,function(n){function u(n){return typeof n=="function"}function o(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function l(n,t){return c.call(n,t)}function v(n){return!l(a,n)}function p(n){return String(n).replace(/[&<>"'\/]/g,function(n){return y[n]})}function g(t,i){function lt(){if(ft&&!g)while(p.length)delete a[p.pop()];else p=[];ft=!1;g=!1}function ht(n){if(typeof n=="string"&&(n=n.split(b,2)),!e(n)||n.length!==2)throw new Error("Invalid tags: "+n);et=new RegExp(o(n[0])+"\\s*");y=new RegExp("\\s*"+o(n[1]));st=new RegExp("\\s*"+o("}"+n[1]))}var et,y,st,u,c,f,h,it,ot,l,rt,ct;if(!t)return[];var ut=[],a=[],p=[],ft=!1,g=!1;for(ht(i||n.tags),u=new r(t);!u.eos();){if(c=u.pos,h=u.scanUntil(et),h)for(rt=0,ct=h.length;rt<ct;++rt)it=h.charAt(rt),v(it)?p.push(a.length):g=!0,a.push(["text",it,c,c+1]),c+=1,it==="\n"&&lt();if(!u.scan(et))break;if(ft=!0,f=u.scan(d)||"name",u.scan(w),f==="="?(h=u.scanUntil(s),u.scan(s),u.scanUntil(y)):f==="{"?(h=u.scanUntil(st),u.scan(k),u.scanUntil(y),f="&"):h=u.scanUntil(y),!u.scan(y))throw new Error("Unclosed tag at "+u.pos);if(ot=[f,h,c,u.pos],a.push(ot),f==="#"||f==="^")ut.push(ot);else if(f==="/"){if(l=ut.pop(),!l)throw new Error('Unopened section "'+h+'" at '+c);if(l[1]!==h)throw new Error('Unclosed section "'+l[1]+'" at '+c);}else f==="name"||f==="{"||f==="&"?g=!0:f==="="&&ht(h)}if(l=ut.pop(),l)throw new Error('Unclosed section "'+l[1]+'" at '+u.pos);return tt(nt(a))}function nt(n){for(var u=[],t,i,r=0,f=n.length;r<f;++r)t=n[r],t&&(t[0]==="text"&&i&&i[0]==="text"?(i[1]+=t[1],i[3]=t[3]):(u.push(t),i=t));return u}function tt(n){for(var u=[],r=u,i=[],t,e,f=0,o=n.length;f<o;++f){t=n[f];switch(t[0]){case"#":case"^":r.push(t);i.push(t);r=t[4]=[];break;case"/":e=i.pop();e[5]=t[2];r=i.length>0?i[i.length-1][4]:u;break;default:r.push(t)}}return u}function r(n){this.string=n;this.tail=n;this.pos=0}function i(n,t){this.view=n==null?{}:n;this.cache={".":this.view};this.parent=t}function t(){this.cache={}}var h=Object.prototype.toString,e=Array.isArray||function(n){return h.call(n)==="[object Array]"},c=RegExp.prototype.test,a=/\S/,y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},w=/\s*/,b=/\s+/,s=/\s*=/,k=/\s*\}/,d=/#|\^|\/|>|\{|&|=|!/,f;r.prototype.eos=function(){return this.tail===""};r.prototype.scan=function(n){var i=this.tail.match(n),t;return!i||i.index!==0?"":(t=i[0],this.tail=this.tail.substring(t.length),this.pos+=t.length,t)};r.prototype.scanUntil=function(n){var i=this.tail.search(n),t;switch(i){case-1:t=this.tail;this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i);this.tail=this.tail.substring(i)}return this.pos+=t.length,t};i.prototype.push=function(n){return new i(n,this)};i.prototype.lookup=function(n){var r=this.cache,t,i,f,e;if(n in r)t=r[n];else{for(i=this;i;){if(n.indexOf(".")>0)for(t=i.view,f=n.split("."),e=0;t!=null&&e<f.length;)t=t[f[e++]];else typeof i.view=="object"&&(t=i.view[n]);if(t!=null)break;i=i.parent}r[n]=t}return u(t)&&(t=t.call(this.view)),t};t.prototype.clearCache=function(){this.cache={}};t.prototype.parse=function(n,t){var r=this.cache,i=r[n];return i==null&&(i=r[n]=g(n,t)),i};t.prototype.render=function(n,t,r){var u=this.parse(n),f=t instanceof i?t:new i(t);return this.renderTokens(u,f,r,n)};t.prototype.renderTokens=function(n,t,i,r){for(var s="",f,e,u,o=0,h=n.length;o<h;++o)u=undefined,f=n[o],e=f[0],e==="#"?u=this._renderSection(f,t,i,r):e==="^"?u=this._renderInverted(f,t,i,r):e===">"?u=this._renderPartial(f,t,i,r):e==="&"?u=this._unescapedValue(f,t):e==="name"?u=this._escapedValue(f,t):e==="text"&&(u=this._rawValue(f)),u!==undefined&&(s+=u);return s};t.prototype._renderSection=function(n,t,i,r){function l(n){return c.render(n,t,i)}var c=this,o="",f=t.lookup(n[1]),s,h;if(f){if(e(f))for(s=0,h=f.length;s<h;++s)o+=this.renderTokens(n[4],t.push(f[s]),i,r);else if(typeof f=="object"||typeof f=="string")o+=this.renderTokens(n[4],t.push(f),i,r);else if(u(f)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");f=f.call(t.view,r.slice(n[3],n[5]),l);f!=null&&(o+=f)}else o+=this.renderTokens(n[4],t,i,r);return o}};t.prototype._renderInverted=function(n,t,i,r){var u=t.lookup(n[1]);if(!u||e(u)&&u.length===0)return this.renderTokens(n[4],t,i,r)};t.prototype._renderPartial=function(n,t,i){if(i){var r=u(i)?i(n[1]):i[n[1]];if(r!=null)return this.renderTokens(this.parse(r),t,i,r)}};t.prototype._unescapedValue=function(n,t){var i=t.lookup(n[1]);if(i!=null)return i};t.prototype._escapedValue=function(t,i){var r=i.lookup(t[1]);if(r!=null)return n.escape(r)};t.prototype._rawValue=function(n){return n[1]};n.name="mustache.js";n.version="1.1.0";n.tags=["{{","}}"];f=new t;n.clearCache=function(){return f.clearCache()};n.parse=function(n,t){return f.parse(n,t)};n.render=function(n,t,i){return f.render(n,t,i)};n.to_html=function(t,i,r,f){var e=n.render(t,i,r);if(u(f))f(e);else return e};n.escape=p;n.Scanner=r;n.Context=i;n.Writer=t});