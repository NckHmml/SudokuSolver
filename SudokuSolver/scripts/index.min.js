(function(){"use strict";function n(){document.addEventListener("pause",t.bind(this),!1);document.addEventListener("resume",i.bind(this),!1)}function t(){}function i(){}document.addEventListener("deviceready",n.bind(this),!1)})();$(function(){function t(n){switch(n){case"field":return i();default:return null}}function i(){for(var t,i={blocks:[]},n=0;n<9;n++)for(i.blocks.push([]),t=0;t<9;t++)i.blocks[n].push({x:t,y:n});return i}function r(){var t,i;$("select:not([data-x='']):not([data-y=''])").removeClass("invalid");var r=$(this),o=r.attr("data-x"),s=r.attr("data-y"),n=[];for(t=0;t<9;t++)for(n.push([]),i=0;i<9;i++)n[t].push(null);$("select:not([data-x='']):not([data-y=''])").each(function(){var t=$(this).attr("data-x"),i=$(this).attr("data-y");n[t][i]=$(this).val()});u(n);f(n);e(n)}function u(n){for(var f,t,e,o,i,r,u=1;u<=9;u++)for(f=[],t=0;t<9;t++){for(f.push(0),e=t%3,o=t-t%3,e*=3,i=0;i<3;i++)for(r=0;r<3;r++)n[i+e][r+o]==u&&f[t]++;if(f[t]>1)for(i=0;i<3;i++)for(r=0;r<3;r++)$("select[data-x='"+(i+e)+"'][data-y='"+(r+o)+"']").addClass("invalid")}}function f(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[u][t]==i&&r[t]++;r[t]>1&&$("select[data-y='"+t+"']").addClass("invalid")}}function e(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[t][u]==i&&r[t]++;r[t]>1&&$("select[data-x='"+t+"']").addClass("invalid")}}function o(){var g,v,u,e,y,b,w,r,f,l,t,i;console.clear();g=0;v=0;do{for(u=[],e=[],y=0;y<9;y++)for(u.push([]),e.push([]),b=0;b<9;b++){for(u[y].push([]),r=1;r<=9;r++)u[y][b].push(r);e[y].push(null)}for($("select:not([data-x='']):not([data-y=''])").each(function(){var n=$(this).attr("data-x"),t=$(this).attr("data-y");e[n][t]=$(this).val()}),t=0;t<9;t++)for(i=0;i<9;i++){if(e[t][i]!=""){u[t][i]=[];continue}for(r=1;r<=9;r++)s(e,t,i,r)?h(e,t,i,r)?c(e,t,i,r)||n(u[t][i],r):n(u[t][i],r):n(u[t][i],r)}for(v=0,r=1;r<=9;r++)for(f=0;f<9;f++){var o=[],a=f%3,p=f-f%3;for(a*=3,t=a;t<a+3;t++)for(i=p;i<p+3;i++)u[t][i].indexOf(r)>=0&&o.push({x:t,y:i});if(!(o.length<=1)){var l=o[0],k=!0,d=!0;for(w=1;w<o.length;w++)k&=o[w].y==l.y,d&=o[w].x==l.x;if(k&&!d)for(t=0;t<9;t++)t>=a&&t<a+3||n(u[t][l.y],r);else if(d&&!k)for(i=0;i<9;i++)i>=p&&i<p+3||n(u[l.x][i],r)}}for(r=1;r<=9;r++)for(f=0;f<9;f++){var o=[],a=f%3,p=f-f%3;for(a*=3,t=a;t<a+3;t++)for(i=p;i<p+3;i++)u[t][i].indexOf(r)>=0&&o.push({x:t,y:i});o.length===1&&(l=o[0],v++,e[l.x][l.y]=r,u[l.x][l.y]=[])}for(t=0;t<9;t++)for(i=0;i<9;i++)u[t][i].length===1&&(v++,e[t][i]=u[t][i],u[t][i]=[]);for(t=0;t<9;t++)for(i=0;i<9;i++)$("select[data-x='"+t+"'][data-y='"+i+"']").val(e[t][i]);console.log(++g+":"+v)}while(v>0)}function s(n,t,i,r){for(var u=0;u<9;u++)if(t!==u&&n[u][i]==r)return!1;return!0}function h(n,t,i,r){for(var u=0;u<9;u++)if(i!==u&&n[t][u]==r)return!1;return!0}function c(n,t,i,r){for(var u,e=t-t%3,o=i-i%3,f=e;f<e+3;f++)for(u=o;u<o+3;u++)if((i!==u||t!=f)&&n[f][u]==r)return!1;return!0}function n(n,t){var i=n.indexOf(t);i<0||n.splice(i,1)}$("#btnSolve").on("click",o);$("[data-template]").each(function(n,i){var u=$(i),f=u.attr("data-template"),e=$("[data-template-name='"+f+"']").html(),o=t(f),s=Mustache.render(e,o);u.append(s);$("select:not([data-x='']):not([data-y=''])").on("change",r)})});