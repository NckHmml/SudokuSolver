(function(){"use strict";function n(){document.addEventListener("pause",t.bind(this),!1);document.addEventListener("resume",i.bind(this),!1)}function t(){}function i(){}document.addEventListener("deviceready",n.bind(this),!1)})();$(function(){function u(n){switch(n){case"field":return f();default:return null}}function f(){for(var t,i={blocks:[]},n=0;n<9;n++)for(i.blocks.push([]),t=0;t<9;t++)i.blocks[n].push({x:t,y:n});return i}function e(){var t,i;$("select:not([data-x='']):not([data-y=''])").removeClass("invalid");var r=$(this),u=r.attr("data-x"),f=r.attr("data-y"),n=[];for(t=0;t<9;t++)for(n.push([]),i=0;i<9;i++)n[t].push(null);$("select:not([data-x='']):not([data-y=''])").each(function(){var t=$(this).attr("data-x"),i=$(this).attr("data-y");n[t][i]=$(this).val()});o(n);s(n);h(n)}function o(n){for(var f,t,e,o,i,r,u=1;u<=9;u++)for(f=[],t=0;t<9;t++){for(f.push(0),e=t%3,o=t-t%3,e*=3,i=0;i<3;i++)for(r=0;r<3;r++)n[i+e][r+o]==u&&f[t]++;if(f[t]>1)for(i=0;i<3;i++)for(r=0;r<3;r++)$("select[data-x='"+(i+e)+"'][data-y='"+(r+o)+"']").addClass("invalid")}}function s(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[u][t]==i&&r[t]++;r[t]>1&&$("select[data-y='"+t+"']").addClass("invalid")}}function h(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[t][u]==i&&r[t]++;r[t]>1&&$("select[data-x='"+t+"']").addClass("invalid")}}function t(){var t=0,u,n,f;do u=[],n=[],t=0,i(n,u),t+=c(n,u),r(n);while(t>0);f=0;$("select:not([data-x='']):not([data-y=''])").each(function(){$(this).val()===""&&f++});f>0&&$("#modalForce").modal()}function i(t,i){for(var o,u,f,r,e=0;e<9;e++)for(i.push([]),t.push([]),o=0;o<9;o++){for(i[e].push([]),r=1;r<=9;r++)i[e][o].push(r);t[e].push(null)}for($("select:not([data-x='']):not([data-y=''])").each(function(){var n=$(this).attr("data-x"),i=$(this).attr("data-y");t[n][i]=$(this).val()}),u=0;u<9;u++)for(f=0;f<9;f++){if(t[u][f]!=""){i[u][f]=[];continue}for(r=1;r<=9;r++)l(t,u,f,r)?a(t,u,f,r)?v(t,u,f,r)||n(i[u][f],r):n(i[u][f],r):n(i[u][f],r)}}function r(n){for(var i,t=0;t<9;t++)for(i=0;i<9;i++)$("select[data-x='"+t+"'][data-y='"+i+"']").val(n[t][i])}function c(t,i){for(var l,f,r,u,s,y=0,e=1;e<=9;e++)for(f=0;f<9;f++){var o=[],h=f%3,c=f-f%3;for(h*=3,r=h;r<h+3;r++)for(u=c;u<c+3;u++)i[r][u].indexOf(e)>=0&&o.push({x:r,y:u});if(!(o.length<=1)){var s=o[0],a=!0,v=!0;for(l=1;l<o.length;l++)a&=o[l].y==s.y,v&=o[l].x==s.x;if(a&&!v)for(r=0;r<9;r++)r>=h&&r<h+3||n(i[r][s.y],e);else if(v&&!a)for(u=0;u<9;u++)u>=c&&u<c+3||n(i[s.x][u],e)}}for(e=1;e<=9;e++)for(f=0;f<9;f++){var o=[],h=f%3,c=f-f%3;for(h*=3,r=h;r<h+3;r++)for(u=c;u<c+3;u++)i[r][u].indexOf(e)>=0&&o.push({x:r,y:u});o.length===1&&(s=o[0],y++,t[s.x][s.y]=e,i[s.x][s.y]=[])}return y}function l(n,t,i,r){for(var u=0;u<9;u++)if(t!==u&&n[u][i]==r)return!1;return!0}function a(n,t,i,r){for(var u=0;u<9;u++)if(i!==u&&n[t][u]==r)return!1;return!0}function v(n,t,i,r){for(var u,e=t-t%3,o=i-i%3,f=e;f<e+3;f++)for(u=o;u<o+3;u++)if((i!==u||t!=f)&&n[f][u]==r)return!1;return!0}function n(n,t){var i=n.indexOf(t);i<0||n.splice(i,1)}function y(){var e=[],f=[],s=[],o=!1,n,u;for(i(f,e),s=f,n=0;n<9;n++){for(u=0;u<9;u++)if(e[n][u].length>0){f[n][u]=e[n][u][0];o=!0;break}if(o)break}r(f);t()}$("#btnSolve").on("click",t);$("#btnForce").on("click",y);$("[data-template]").each(function(n,t){var i=$(t),r=i.attr("data-template"),f=$("[data-template-name='"+r+"']").html(),o=u(r),s=Mustache.render(f,o);i.append(s);$("select:not([data-x='']):not([data-y=''])").on("change",e)})});