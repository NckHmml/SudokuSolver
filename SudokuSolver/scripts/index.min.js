(function(){"use strict";function n(){document.addEventListener("pause",t.bind(this),!1);document.addEventListener("resume",i.bind(this),!1)}function t(){}function i(){}document.addEventListener("deviceready",n.bind(this),!1)})();$(function(){function o(n){switch(n){case"field":return s();default:return null}}function s(){for(var t,i={blocks:[]},n=0;n<9;n++)for(i.blocks.push([]),t=0;t<9;t++)i.blocks[n].push({x:t,y:n});return i}function h(){var t,i;$("select:not([data-x='']):not([data-y=''])").removeClass("invalid");var r=$(this),u=r.attr("data-x"),f=r.attr("data-y"),n=[];for(t=0;t<9;t++)for(n.push([]),i=0;i<9;i++)n[t].push(null);$("select:not([data-x='']):not([data-y=''])").each(function(){var t=$(this).attr("data-x"),i=$(this).attr("data-y");n[t][i]=$(this).val()});c(n);l(n);a(n)}function c(n){for(var f,t,e,o,i,r,u=1;u<=9;u++)for(f=[],t=0;t<9;t++){for(f.push(0),e=t%3,o=t-t%3,e*=3,i=0;i<3;i++)for(r=0;r<3;r++)n[i+e][r+o]==u&&f[t]++;if(f[t]>1)for(i=0;i<3;i++)for(r=0;r<3;r++)$("select[data-x='"+(i+e)+"'][data-y='"+(r+o)+"']").addClass("invalid")}}function l(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[u][t]==i&&r[t]++;r[t]>1&&$("select[data-y='"+t+"']").addClass("invalid")}}function a(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[t][u]==i&&r[t]++;r[t]>1&&$("select[data-x='"+t+"']").addClass("invalid")}}function v(){var o=[],n=[],s=0;e();i(n);do o=[],r(n,o),s=0+f(n,o);while(s>0);u(n);t(n)>0&&$("#modalForce").modal()}function i(n){for(var i,t=0;t<9;t++)for(n.push([]),i=0;i<9;i++)n[t].push(null);$("select:not([data-x='']):not([data-y=''])").each(function(){var t=$(this).attr("data-x"),i=$(this).attr("data-y");n[t][i]=$(this).val()})}function r(t,i){for(var o,u,f,r,e=0;e<9;e++)for(i.push([]),o=0;o<9;o++)for(i[e].push([]),r=1;r<=9;r++)i[e][o].push(r);for(u=0;u<9;u++)for(f=0;f<9;f++){if(t[u][f]!=""){i[u][f]=[];continue}for(r=1;r<=9;r++)y(t,u,f,r)?p(t,u,f,r)?w(t,u,f,r)||n(i[u][f],r):n(i[u][f],r):n(i[u][f],r)}}function u(n){for(var i,t=0;t<9;t++)for(i=0;i<9;i++)$("select[data-x='"+t+"'][data-y='"+i+"']").val(n[t][i])}function f(t,i){for(var l,f,r,u,s,y=0,e=1;e<=9;e++)for(f=0;f<9;f++){var o=[],h=f%3,c=f-f%3;for(h*=3,r=h;r<h+3;r++)for(u=c;u<c+3;u++)i[r][u].indexOf(e)>=0&&o.push({x:r,y:u});if(!(o.length<=1)){var s=o[0],a=!0,v=!0;for(l=1;l<o.length;l++)a&=o[l].y==s.y,v&=o[l].x==s.x;if(a&&!v)for(r=0;r<9;r++)r>=h&&r<h+3||n(i[r][s.y],e);else if(v&&!a)for(u=0;u<9;u++)u>=c&&u<c+3||n(i[s.x][u],e)}}for(e=1;e<=9;e++)for(f=0;f<9;f++){var o=[],h=f%3,c=f-f%3;for(h*=3,r=h;r<h+3;r++)for(u=c;u<c+3;u++)i[r][u].indexOf(e)>=0&&o.push({x:r,y:u});o.length===1&&(s=o[0],y++,t[s.x][s.y]=e,i[s.x][s.y]=[])}return y}function y(n,t,i,r){for(var u=0;u<9;u++)if(t!==u&&n[u][i]==r)return!1;return!0}function p(n,t,i,r){for(var u=0;u<9;u++)if(i!==u&&n[t][u]==r)return!1;return!0}function w(n,t,i,r){for(var u,e=t-t%3,o=i-i%3,f=e;f<e+3;f++)for(u=o;u<o+3;u++)if((i!==u||t!=f)&&n[f][u]==r)return!1;return!0}function n(n,t){var i=n.indexOf(t);i<0||n.splice(i,1)}function b(){var e=[],n=[],a=[],c,h=0,l,o,s,v;for(i(n),c=999,a=n;h<9;){while(c>0){if(c==t(n))break;for(c=t(n),e=[],r(n,e),l=!1,o=0;o<9;o++){for(s=0;s<9;s++)if(e[o][s].length>h){n[o][s]=e[o][s][h];h=0;l=!0;break}if(l)break}do e=[],r(n,e),v=0+f(n,e);while(v>0)}if(t(n)===0)break;n=a;h++}t(n)>0?$("#modalFailed").modal():u(n)}function t(n){var t=0;return $.each(n,function(i){$.each(n[i],function(r){n[i][r]===""&&t++})}),t}function k(){var n=[];i(n);$("#txtSave").val(JSON.stringify(n));$("#modalSave").modal()}function d(){var n=JSON.parse($("#txtLoad").val());u(n);e()}function e(){$("select:not([data-x='']):not([data-y=''])").each(function(){$(this).val()!==""?$(this).addClass("original"):$(this).removeClass("original")})}$("#btnSolve").on("click",v);$("#btnForce").on("click",b);$("#btnSave").on("click",k);$("#btnLoad").on("click",d);$("[data-template]").each(function(n,t){var i=$(t),r=i.attr("data-template"),u=$("[data-template-name='"+r+"']").html(),f=o(r),e=Mustache.render(u,f);i.append(e);$("select:not([data-x='']):not([data-y=''])").on("change",h)})});