(function(){"use strict";function n(){document.addEventListener("pause",t.bind(this),!1);document.addEventListener("resume",i.bind(this),!1)}function t(){}function i(){}document.addEventListener("deviceready",n.bind(this),!1)})();$(function(){function s(n){switch(n){case"field":return h();default:return null}}function h(){for(var t,i={blocks:[]},n=0;n<9;n++)for(i.blocks.push([]),t=0;t<9;t++)i.blocks[n].push({x:t,y:n});return i}function c(){var r,n,t,i;for($("input[type='number']:not([data-x='']):not([data-y=''])").removeClass("invalid"),r=$(this),n=[],t=0;t<9;t++)for(n.push([]),i=0;i<9;i++)n[t].push(null);$("input[type='number']:not([data-x='']):not([data-y=''])").each(function(){var t=$(this).attr("data-x"),i=$(this).attr("data-y");n[t][i]=$(this).val()});l(n);a(n);v(n)}function l(n){for(var f,t,e,o,i,r,u=1;u<=9;u++)for(f=[],t=0;t<9;t++){for(f.push(0),e=t%3,o=t-t%3,e*=3,i=0;i<3;i++)for(r=0;r<3;r++)n[i+e][r+o]==u&&f[t]++;if(f[t]>1)for(i=0;i<3;i++)for(r=0;r<3;r++)$("input[data-x='"+(i+e)+"'][data-y='"+(r+o)+"']").addClass("invalid")}}function a(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[u][t]==i&&r[t]++;r[t]>1&&$("input[data-y='"+t+"']").addClass("invalid")}}function v(n){for(var r,t,u,i=1;i<=9;i++)for(r=[],t=0;t<9;t++){for(r.push(0),u=0;u<9;u++)n[t][u]==i&&r[t]++;r[t]>1&&$("input[data-x='"+t+"']").addClass("invalid")}}function y(){var t=[],n=[],s=0;xSolved=0;o();r(n);do s=0,t=[],s+=f(n,t),t=[],s+=e(n,t);while(s>0);u(n);i(n)>0&&$("#modalForce").modal()}function r(n){for(var i,t=0;t<9;t++)for(n.push([]),i=0;i<9;i++)n[t].push(null);$("input[type='number']:not([data-x='']):not([data-y=''])").each(function(){var t=$(this).attr("data-x"),i=$(this).attr("data-y");n[t][i]=$(this).val()})}function t(t,i){for(var o,u,f,r,e=0;e<9;e++)for(i.push([]),o=0;o<9;o++)for(i[e].push([]),r=1;r<=9;r++)i[e][o].push(r);for(u=0;u<9;u++)for(f=0;f<9;f++){if(t[u][f]!==""){i[u][f]=[];continue}for(r=1;r<=9;r++)p(t,u,f,r)?w(t,u,f,r)?b(t,u,f,r)||n(i[u][f],r):n(i[u][f],r):n(i[u][f],r)}}function u(n){for(var i,t=0;t<9;t++)for(i=0;i<9;i++)$("input[data-x='"+t+"'][data-y='"+i+"']").val(n[t][i])}function f(i,r){var a,o,e,u,f,h;for(t(i,r),o=1;o<=9;o++)for(e=0;e<9;e++){var s=[],c=e%3,l=e-e%3;for(c*=3,u=c;u<c+3;u++)for(f=l;f<l+3;f++)r[u][f].indexOf(o)>=0&&s.push({x:u,y:f});if(!(s.length<=1)){var h=s[0],v=!0,y=!0;for(a=1;a<s.length;a++)v&=s[a].y===h.y,y&=s[a].x===h.x;if(v&&!y)for(u=0;u<9;u++)u>=c&&u<c+3||n(r[u][h.y],o);else if(y&&!v)for(f=0;f<9;f++)f>=l&&f<l+3||n(r[h.x][f],o)}}for(o=1;o<=9;o++)for(e=0;e<9;e++){var s=[],c=e%3,l=e-e%3;for(c*=3,u=c;u<c+3;u++)for(f=l;f<l+3;f++)r[u][f].indexOf(o)>=0&&s.push({x:u,y:f});if(s.length===1)return h=s[0],i[h.x][h.y]=o,r[h.x][h.y]=[],1}return 0}function e(n,i){var r,u;for(t(n,i),tt(n,i),r=0;r<9;r++)for(u=0;u<9;u++)if(i[r][u].length===1)return n[r][u]=i[r][u][0],1;return 0}function p(n,t,i,r){for(var u=0;u<9;u++)if(t!==u&&n[u][i]==r)return!1;return!0}function w(n,t,i,r){for(var u=0;u<9;u++)if(i!==u&&n[t][u]==r)return!1;return!0}function b(n,t,i,r){for(var u,e=t-t%3,o=i-i%3,f=e;f<e+3;f++)for(u=o;u<o+3;u++)if((i!==u||t!=f)&&n[f][u]==r)return!1;return!0}function n(n,t){var i=n.indexOf(t);i<0||n.splice(i,1)}function k(){var n=[];r(n);t(n,[]);d(n)?u(n):$("#modalFailed").modal()}function d(n){for(var h=999,r=[],l=n,s,c,u,o;h>0;){if(h==i(n))break;for(h=i(n),r=[],t(n,r),c=!1,u=0;u<9;u++){for(o=0;o<9;o++)if(r[u][o].length>0){n[u][o]=r[u][o][0];c=!0;break}if(c)break}do s=0,r=[],s+=f(n,r),r=[],s+=e(n,r);while(s>0);if(i(n)===0)return!0;n=l}return!1}function i(n){var t=0;return $.each(n,function(i){$.each(n[i],function(r){n[i][r]===""&&t++})}),t}function g(){var n=[];r(n);$("#txtSave").val(JSON.stringify(n));$("#modalSave").modal()}function nt(){var n=JSON.parse($("#txtLoad").val());$("input[type='number']:not([data-x='']):not([data-y=''])").removeClass("invalid");u(n);o()}function o(){$("input[type='number']:not([data-x='']):not([data-y=''])").each(function(){$(this).val()!==""?$(this).addClass("original"):$(this).removeClass("original")})}function tt(t,i){for(var e,o,r,s,h,u,f=1;f<=9;f++){for(e=[],r=0;r<9;r++){for(o=0,u=0;u<9;u++)i[u][r].indexOf(f)!==-1&&o++;o===2&&e.push({y:r,val:f})}if(e.length===2)for(f=e[0].val,u=0;u<9;u++)if(s=i[u][e[0].y].indexOf(f)!==-1,h=i[u][e[1].y].indexOf(f)!==-1,s&&h)for(r=0;r<9;r++)r!==e[0].y&&r!==e[1].y&&n(i[u][r],f)}for(f=1;f<=9;f++){for(e=[],u=0;u<9;u++){for(o=0,r=0;r<9;r++)i[u][r].indexOf(f)!==-1&&o++;o===2&&e.push({x:u,val:f})}if(e.length===2)for(f=e[0].val,r=0;r<9;r++)if(s=i[e[0].x][r].indexOf(f)!==-1,h=i[e[1].x][r].indexOf(f)!==-1,s&&h)for(u=0;u<9;u++)u!==e[0].x&&u!==e[1].x&&n(i[u][r],f)}}$("#btnSolve").on("click",y);$("#btnForce").on("click",k);$("#btnSave").on("click",g);$("#btnLoad").on("click",nt);$("[data-template]").each(function(n,t){var i=$(t),r=i.attr("data-template"),u=$("[data-template-name='"+r+"']").html(),f=s(r),e=Mustache.render(u,f);i.append(e);$("input[type='number']:not([data-x='']):not([data-y=''])").on("change",c)})});